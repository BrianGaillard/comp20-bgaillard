<!DOCTYPE html>
<html>
  <head>
	<title>Lyft Knochoff</title>
	<meta name="viewport" content="initial-scale=1.0">
	<link rel="stylesheet" href="style.css"/>
	<meta charset="utf-8">
  </head>

  <body>
  	<div id="map"></div>
	<script>

	var myLat = 0.0;
	var myLng = 0.0;
	var me;
	var marker;
	var infoWindow;
	var map;

	function initMap() {
		map = new google.maps.Map(document.getElementById("map"), {
			center: {lat: myLat, lng: myLng},
			zoom: 13
		});
		getMyLocation();
	}

	function getMyLocation() {
		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position){
			myLat = position.coords.latitude;
			myLng = position.coords.longitude;
			renderMap();
		});
	}
}

	function renderMap() {
		me = new google.maps.LatLng(myLat,myLng);
		map.panTo(me);
		marker = new google.maps.Marker({
			position: me,
			title: "You are here"
		});
		marker.setMap(map);

		infoWindow = new google.maps.InfoWindow();
		google.maps.event.addListener(marker,'click',function() {
			infoWindow.setContent(marker.title);
			infoWindow.open(map, marker);
		});
		getData();
	}

	function getData(){
		request = new XMLHttpRequest();

		request.open("POST", "https://hans-moleman.herokuapp.com/rides", true);

		request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

		request.onreadystatechange = function(){
			if (request.readyState == 4 && request.status == 200) {
				data = JSON.parse(request.responseText);
			}
		}

		request.send("username=m4Phs9fb&lat="+myLat+"&lng="+myLng);
	}




	</script>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDHoxaiygdYABk5OHIZMOt-iizqXgrsdB8&callback=initMap"
	async defer> </script>
	
	<div id="infoWindow"></div>
   
  </body>
</html>